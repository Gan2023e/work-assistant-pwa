# 前端库存管理功能使用指南

## 🚀 新功能概览

本次更新为前端添加了完整的库存管理功能，包括：

- **库存管理主页面** - 查看、编辑、删除库存记录
- **库存入库页面** - 支持单个、批量、混合箱入库
- **打印管理功能** - 本地打印服务集成
- **首页快捷入口** - 便捷的功能访问

## 📂 新增页面和组件

### 1. 库存管理页面
**路径:** `/inventory/management`  
**文件:** `frontend/src/pages/Inventory/InventoryManagement.tsx`

**功能特点:**
- 🔍 库存汇总和记录详情双视图
- 📊 高效的状态筛选和搜索
- ✏️ 在线编辑库存信息
- 🗑️ 安全的软删除功能
- 🖨️ 一键打印标签

**主要功能区域:**
```
┌─ 筛选区域 ──────────────────────────────────┐
│ SKU搜索 | 国家选择 | 箱型选择 | 状态筛选     │
├─ 视图切换 ──────────────────────────────────┤
│ 库存汇总 | 库存记录                         │
├─ 数据表格 ──────────────────────────────────┤
│ 分页显示 | 排序 | 编辑 | 删除 | 打印       │
└─────────────────────────────────────────────┘
```

### 2. 库存入库页面
**路径:** `/inventory/create`  
**文件:** `frontend/src/pages/Inventory/InventoryCreate.tsx`

**入库类型:**
- 📦 **单个入库** - 一次录入一个SKU
- 📋 **批量入库** - 批量添加多个SKU
- 🎁 **混合箱入库** - 一个箱子包含多个SKU

**界面特点:**
```
┌─ 打印服务状态提示 ──────────────────────────┐
├─ 入库类型选择 ─────────────────────────────┤
│ 单个入库 | 批量入库 | 混合箱入库           │
├─ 表单区域 ────────────────────────────────┤
│ 根据选择的类型显示不同的表单界面           │
├─ 自动打印选项 ─────────────────────────────┤
│ 入库成功后是否自动打印外箱单               │
└───────────────────────────────────────────┘
```

### 3. 打印管理组件
**文件:** `frontend/src/components/PrintManager.tsx`

**核心功能:**
- 🖨️ 打印服务状态检测
- 📋 打印机列表管理
- 🧪 打印功能测试
- 📖 使用说明指导

**组件结构:**
```
┌─ PrintManagerComponent ──────────────────────┐
│ • 打印服务状态显示                           │
│ • 打印机选择和配置                           │
│ • 测试打印功能                               │
│ • 启动服务指导                               │
└─────────────────────────────────────────────┘

┌─ PrintStatusIndicator ───────────────────────┐
│ • 实时服务状态指示器                         │
│ • 30秒自动检查状态                           │
└─────────────────────────────────────────────┘
```

## 🔧 打印功能使用指南

### 启动本地打印服务

1. **打开终端/命令行**
2. **进入后端目录**
   ```bash
   cd backend
   ```
3. **启动打印服务**
   ```bash
   node scripts/startPrintService.js
   ```
4. **确认服务启动**
   看到 "🖨️ 打印服务已启动" 提示

### 打印功能特点

**支持的打印方式:**
- 🖨️ **HTML打印** - 适用于普通打印机
- 🏷️ **ZPL打印** - 适用于专业标签打印机
- 🌐 **浏览器打印** - 备用方案

**标签内容包含:**
- 记录号（含条码）
- SKU信息
- 数量和箱数
- 目的地国家
- 操作员和打包员
- 入库时间
- 混合箱信息（如适用）

**打印时机:**
- ✅ 入库时自动打印
- ✅ 库存管理页面手动打印
- ✅ 批量打印多个记录

## 🎯 使用流程

### 完整的库存管理流程

```
1. 入库操作
   ┌─ 打开 /inventory/create ────────────────┐
   │ → 选择入库类型                         │
   │ → 填写商品信息                         │
   │ → 选择自动打印                         │
   │ → 确认入库                             │
   │ → 自动打印外箱单（可选）               │
   └───────────────────────────────────────┘
           ↓
2. 库存管理
   ┌─ 打开 /inventory/management ──────────┐
   │ → 查看库存汇总                         │
   │ → 筛选和搜索                           │
   │ → 编辑库存信息                         │
   │ → 手动打印标签                         │
   │ → 删除错误记录                         │
   └───────────────────────────────────────┘
           ↓
3. 出库操作
   ┌─ 现有出库流程 ─────────────────────────┐
   │ → 系统自动更新库存状态为"已出库"       │
   │ → 保留完整历史记录                     │
   │ → 支持取消出库恢复状态                 │
   └───────────────────────────────────────┘
```

## 📱 导航和入口

### 主菜单入口
```
库存管理
├── 库存管理      (/inventory/management)
├── 库存入库      (/inventory/create)
├── SKU映射管理   (/inventory/sku-mapping)
├── 旺季备货汇总  (/inventory/summary)
├── 厂家发货与付款 (/inventory/supplier)
└── FBA库存       (/inventory/fba-inventory)
```

### 首页快捷入口
- 🚀 **快速入库** - 直接跳转到入库页面
- 📋 **库存管理** - 直接跳转到管理页面
- 🖨️ **打印设置** - 打开打印管理对话框

## 🔍 界面细节说明

### 库存管理页面操作指南

**筛选和搜索:**
- SKU搜索支持模糊匹配
- 国家选择支持多个主要站点
- 箱型筛选：整箱/混合箱
- 状态筛选：待出库/已出库/已取消

**表格操作:**
- 📊 **库存汇总视图** - 按SKU+国家分组的汇总信息
- 📋 **库存记录视图** - 详细的单条记录信息
- ✏️ **编辑** - 只能编辑"待出库"状态的记录
- 🗑️ **删除** - 软删除，标记为"已取消"状态
- 🖨️ **打印** - 打印该记录的外箱单

### 入库页面使用技巧

**单个入库:**
- 适合少量、单一SKU的录入
- 支持完整的商品信息录入

**批量入库:**
- 先录入公共信息（操作员、备注）
- 逐个添加SKU到批量列表
- 一次性提交所有记录

**混合箱入库:**
- 先设置混合箱编号和操作员信息
- 逐个添加混合箱内的SKU
- 系统自动关联为同一混合箱

## ⚠️ 注意事项

### 数据安全
- ✅ 所有删除操作都是软删除
- ✅ 完整的操作历史记录
- ✅ 支持状态回滚和恢复

### 混合箱管理
- ⚠️ 混合箱必须整箱出库
- ⚠️ 混合箱内SKU不能单独出库
- ✅ 支持混合箱详情查看

### 打印功能
- 🖨️ 本地打印服务需要手动启动
- 🌐 打印服务不可用时自动使用浏览器打印
- 📱 移动端可能无法使用本地打印服务

### 性能考虑
- 📊 大量数据时使用分页显示
- 🔍 筛选条件可提高查询效率
- ⚡ 索引优化确保查询速度

## 🛠️ 故障排除

### 打印问题
**问题:** 打印服务显示不可用
**解决:** 
1. 确认后端打印服务已启动
2. 检查端口3001是否被占用
3. 确认防火墙设置允许本地连接

**问题:** 打印质量差或格式错误
**解决:**
1. 在打印管理中测试打印功能
2. 选择合适的打印机
3. 调整打印机设置

### 数据问题
**问题:** 库存数据不显示
**解决:**
1. 检查筛选条件是否过于严格
2. 确认网络连接正常
3. 刷新页面重新加载数据

**问题:** 编辑保存失败
**解决:**
1. 确认记录状态为"待出库"
2. 检查必填字段是否完整
3. 确认没有其他用户同时编辑

## 🔮 后续规划

- 📊 **库存报表** - 更丰富的统计分析
- 📱 **移动端优化** - 更好的手机端体验
- 🔔 **消息提醒** - 库存异常提醒
- 🚀 **批量操作** - 更多批量处理功能

---

**版本信息:** 库存管理优化版本 v2.0  
**更新日期:** 2025年1月3日  
**技术支持:** 如有问题请查看 `INVENTORY_OPTIMIZATION_GUIDE.md` 