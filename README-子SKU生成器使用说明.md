# 子SKU生成器使用说明

## 功能概述

子SKU生成器是一个用于根据母SKU自动生成包含子SKU信息的Excel文件的工具。它可以从数据库中查询子SKU数据，并按照指定格式填充到Excel模板中，生成可用于Amazon UK市场的产品资料表。

## 功能特点

- 🚀 **高效处理**: 支持批量处理最多50个母SKU
- 📊 **智能分组**: 按母SKU分组，先填写母SKU行，再填写子SKU行
- 📁 **格式兼容**: 支持.xlsx、.xls、.xlsm格式的Excel文件
- 💾 **模板缓存**: 智能缓存机制，提升处理速度
- 🎯 **精确匹配**: 自动查询数据库中的颜色和尺寸信息
- 📝 **智能命名**: 文件名格式为"UK_SKU1_SKU2_SKU3"

## 使用步骤

### 1. 准备Excel模板

**模板要求**：
- 必须包含名为"Template"的工作表
- 第3行必须包含以下列：
  - `item_sku`: 商品SKU列
  - `color_name`: 颜色名称列
  - `size_name`: 尺寸名称列
- 文件大小不超过50MB
- 支持的格式：.xlsx、.xls、.xlsm

**模板示例**：
```
第1行: 标题行（可选）
第2行: 说明行（可选）
第3行: item_sku | color_name | size_name | 其他列...
第4行: 数据开始填充位置
```

### 2. 上传模板

1. 点击"子SKU生成器"按钮
2. 在步骤1中，选择并上传Excel模板文件
3. 系统会自动验证模板格式
4. 上传成功后会显示模板信息

### 3. 输入SKU

1. 在步骤2的文本框中输入需要处理的母SKU
2. 每行输入一个SKU，例如：
   ```
   XBC120
   DEF456
   GHI789
   ```
3. 系统会实时显示已输入的SKU数量

### 4. 生成文件

1. 点击"生成子SKU文件"按钮
2. 系统会显示处理进度：
   - 验证数据
   - 查询数据库
   - 生成Excel文件
   - 下载文件
3. 处理完成后文件会自动下载

## 数据填充规则

### 填充顺序
1. **母SKU行**: 格式为"UK" + 母SKU，颜色和尺寸列为空
2. **子SKU行**: 格式为"UK" + 子SKU，填充对应的颜色和尺寸信息

### 填充示例
假设输入母SKU为"XBC120"，数据库中有以下子SKU：
- XBC120A (黑色, S)
- XBC120B (粉色, M)
- XBC120C (蓝色, L)

生成的Excel文件内容：
```
item_sku    | color_name | size_name
UKXBC120    |            |
UKXBC120A   | 黑色       | S
UKXBC120B   | 粉色       | M
UKXBC120C   | 蓝色       | L
```

## 文件命名规则

生成的文件名格式：`UK_SKU1_SKU2_SKU3.扩展名`

**示例**：
- 输入1个SKU: `UK_XBC120.xlsx`
- 输入3个SKU: `UK_XBC120_DEF456_GHI789.xlsx`
- 输入5个SKU: `UK_XBC120_DEF456_GHI789_more.xlsx`

## 使用限制

| 项目 | 限制 | 说明 |
|------|------|------|
| SKU数量 | 最多50个 | 一次处理超过50个SKU需要分批处理 |
| 模板大小 | 最大50MB | 超过限制需要压缩或分割模板 |
| 处理时间 | 3分钟超时 | 超时会自动取消，建议减少SKU数量 |
| 文件格式 | .xlsx/.xls/.xlsm | 其他格式不支持 |

## 错误代码说明

| 错误代码 | 含义 | 解决方案 |
|----------|------|----------|
| INVALID_INPUT | 输入参数无效 | 检查SKU输入是否为空 |
| INVALID_TEMPLATE | 模板文件无效 | 重新选择有效的模板文件 |
| EMPTY_SKU_LIST | SKU列表为空 | 确保输入了有效的SKU |
| TOO_MANY_SKUS | SKU数量超限 | 减少SKU数量，分批处理 |
| TEMPLATE_NOT_FOUND | 模板文件不存在 | 重新上传模板文件 |
| INVALID_EXCEL_FORMAT | Excel格式错误 | 检查文件是否损坏，重新上传 |
| INVALID_TEMPLATE_FORMAT | 模板格式不符合要求 | 按照模板要求重新制作 |
| NO_SKU_DATA | 未找到SKU数据 | 检查SKU是否存在于数据库中 |
| DATABASE_ERROR | 数据库错误 | 稍后重试或联系管理员 |
| TIMEOUT | 处理超时 | 减少SKU数量重试 |

## 常见问题

### Q: 为什么找不到子SKU数据？
A: 可能的原因：
- 输入的母SKU不存在于数据库中
- SKU格式不正确（注意大小写）
- 数据尚未同步到系统中

### Q: 为什么模板验证失败？
A: 请检查：
- 是否包含名为"Template"的工作表
- 第3行是否包含必需的列名
- 列名是否完全匹配（区分大小写）

### Q: 为什么处理超时？
A: 建议：
- 减少一次处理的SKU数量（建议不超过20个）
- 检查网络连接
- 稍后重试

### Q: 生成的文件为什么打不开？
A: 可能原因：
- 网络中断导致下载不完整
- 浏览器兼容性问题
- 文件损坏，建议重新生成

## 技术规格

### 系统要求
- 现代浏览器（Chrome、Firefox、Safari、Edge）
- 稳定的网络连接
- JavaScript启用

### 性能指标
- 模板缓存时间：10分钟
- 单次处理限制：50个SKU
- 文件大小限制：50MB
- 处理超时时间：3分钟

### 数据来源
- 数据库表：`sellerinventory_sku`
- 查询字段：`child_sku`, `parent_sku`, `sellercolorname`, `sellersizename`
- 排序方式：按母SKU和子SKU排序

## 更新记录

### v2.0.0 (2025-01-XX)
- ✅ 完全重写用户界面，采用步骤式设计
- ✅ 优化Excel处理逻辑，提升格式兼容性
- ✅ 改进错误处理，提供详细的错误信息
- ✅ 增强模板缓存机制，提升性能
- ✅ 统一API响应格式，便于前端处理
- ✅ 添加处理进度显示，提升用户体验

### v1.x.x
- 基础功能实现
- Excel文件生成
- 简单的错误处理

---

如有问题或建议，请联系系统管理员。 